{% extends "base.html" %}
{% load static %}
{% block title %}Upload Dataset - Recommender System{% endblock %}

{% block body %}
<div class="upload-container">
    <div class="upload-card">
        <h1><i class = "fas fa-cloud-upload-alt"></i> Upload Video </h1>

        <form id = "uploadForm" enctype = "multipart/form-data">
            {% csrf_token %}
            <div class = "upload-area" id = "uploadArea">
                <input type = "file" name = "video_file" id = "videoFile" accept = "video/*" hidden/>
                <div class="upload-placeholder">
                    <i class = "fas fa-video"></i>
                    <h3>Drag & Drop Video File</h3>
                    <p>or</p>
                    <button type="button" class = "btn btn-primary" id = "selectFileBtn">Select File</button>
                    <p class = "help-text">MP4, WebM, or MOV. Max 100MB</p>
                </div>
                <div class="upload-preview" id = "uploadPreview" style = "display: none;">
                    <video id = "previewVideo" controls></video>
                    <button type="button" class = "btn btn-outline" id = "changeFileBtn">Change File</button>
                </div>
            </div>

            <div class="form-group">
                <label>Title *</label>
                <input type="text" name="title" maxlength="300" placeholder="Enter Video Title" required />
            </div>

            <div class="form-group">
                <label>Description</label>
                <textarea name="description" rows="4" placeholder="Enter Video Description (optional)"></textarea>
            </div>

            <div class="form-group">
                <label for="categories">Categories *</label>
                <select id="categories" name="categories" multiple required>
                    <option value="">-- Select Categories --</option>
                    {# Categories will be loaded via AJAX #}
                </select>
                <small class="form-text">Select one or more categories (Hold Ctrl/Cmd to select multiple)</small>
            </div>

            <div class="form-group">
                <label>Thumbnail (Optional)</label>
                <input type="file" name="thumbnail" accept="image/*">
            </div>

            <div class="upload-actions">
                <button type="button" class="btn btn-outline" onclick="history.back()">Cancel</button>
                <button type="submit" class="btn btn-primary" id="submitBtn"><i class="fas fa-upload"></i> Upload Video</button>
            </div>

            <div class="upload-progress" id="uploadProgress" style="display: none;">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <p id="progressText">Uploading... 0%</p>
            </div>
        </form>

    </div>
</div>

{% block extra_js %}
{% comment %} <script>
    const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;
</script> {% endcomment %}
<script src="{% static 'js/upload.js' %}"></script>
{% endblock %}

{% endblock %}